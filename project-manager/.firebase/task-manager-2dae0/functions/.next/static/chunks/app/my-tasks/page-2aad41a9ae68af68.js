(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{1774:(e,s,t)=>{Promise.resolve().then(t.bind(t,5673))},5673:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var a=t(5155),l=t(2115),r=t(5317),i=t(8915),n=t(8794),d=t(6671),o=t(6874),c=t.n(o),u=t(5784),x=t(7737);let m=()=>(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[(0,a.jsx)(x.E,{className:"h-9 w-48"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full md:w-auto",children:[(0,a.jsx)(x.E,{className:"h-10 w-full sm:w-[180px]"}),(0,a.jsx)(x.E,{className:"h-10 w-full sm:w-[180px]"})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((e,s)=>(0,a.jsxs)("div",{className:"p-4 border rounded-lg flex flex-col sm:flex-row justify-between items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(x.E,{className:"h-6 w-3/4"}),(0,a.jsx)(x.E,{className:"h-4 w-full"})]}),(0,a.jsx)(x.E,{className:"h-10 w-full sm:w-40"})]},s))})]});var h=t(4378),p=t(4156),f=t(7168),j=t(7550);let b=(0,t(9946).A)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var g=t(9074),v=t(5695),w=t(3008);let{db:y}=(0,i.M)(),N=()=>{let{user:e}=(0,n.A)(),s=(0,v.useRouter)(),[t,i]=(0,l.useState)([]),[o,x]=(0,l.useState)(!0),[N,k]=(0,l.useState)("asc"),[C,z]=(0,l.useState)("all");(0,l.useEffect)(()=>{if(!e)return void x(!1);x(!0);let s=(0,r.P)((0,r.Cs)(y,"subtasks"),(0,r._M)("assignedTo","==",e.uid)),t=(0,r.P)((0,r.Cs)(y,"tasks"),(0,r._M)("assignedTo","==",e.uid)),a=!1,l=!1,n=(0,r.aQ)(s,async e=>{let s=[];for(let t of e.docs){let e={id:t.id,...t.data()},a=t.ref.parent.parent,l=null==a?void 0:a.parent.parent;if(a&&l)try{let t=await (0,r.x7)(a),i=await (0,r.x7)(l);t.exists()&&i.exists()&&s.push({...e,boardId:l.id,boardName:i.data().name,taskId:a.id,taskTitle:t.data().title,type:"subtask"})}catch(e){console.error("Error fetching subtask details:",e)}}i(e=>[...e.filter(e=>"task"===e.type),...s]),a=!0,l&&x(!1)},e=>{console.error("Error with subtasks listener:",e),d.oR.error("Could not listen for subtask updates."),a=!0,l&&x(!1)}),o=(0,r.aQ)(t,async e=>{let s=[];for(let t of e.docs){let e={id:t.id,...t.data()},a=t.ref.parent.parent;if(a)try{let t=await (0,r.x7)(a);t.exists()&&s.push({...e,boardId:a.id,boardName:t.data().name,type:"task"})}catch(e){console.error("Error fetching task details:",e)}}i(e=>[...e.filter(e=>"subtask"===e.type),...s]),l=!0,a&&x(!1)},e=>{console.error("Error with tasks listener:",e),d.oR.error("Could not listen for task updates."),l=!0,a&&x(!1)});return()=>{n(),o()}},[e]);let E=async(e,s)=>{try{let t;t="subtask"===e.type?(0,r.H9)(y,"boards",e.boardId,"tasks",e.taskId,"subtasks",e.id):(0,r.H9)(y,"boards",e.boardId,"tasks",e.id),await (0,r.mZ)(t,{status:s}),i(t=>t.map(t=>t.id===e.id?{...t,status:s}:t)),d.oR.success("Task status updated!")}catch(e){console.log("Error updating task status:",e),d.oR.error("Failed to update status.")}},_=(0,l.useMemo)(()=>{let e=[...t];return"all"!==C&&(e=e.filter(e=>e.status===C)),e.sort((e,s)=>{let t="subtask"===e.type?e.taskTitle.toLowerCase():e.title.toLowerCase(),a="subtask"===s.type?s.taskTitle.toLowerCase():s.title.toLowerCase();return t<a?"asc"===N?-1:1:t>a?"asc"===N?1:-1:0}),e},[t,C,N]);return o?(0,a.jsx)(m,{}):(0,a.jsx)(p.q,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(h.Y,{}),(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsxs)(f.$,{variant:"outline",onClick:()=>s.back(),className:"flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4"}),"Back"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"My Tasks"})]}),(0,a.jsx)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full md:w-auto",children:[(0,a.jsxs)(u.l6,{value:C,onValueChange:z,children:[(0,a.jsx)(u.bq,{className:"w-full sm:w-[180px]",children:(0,a.jsx)(u.yv,{placeholder:"Filter by status"})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"all",children:"All Statuses"}),(0,a.jsx)(u.eb,{value:"todo",children:"To Do"}),(0,a.jsx)(u.eb,{value:"in-progress",children:"In Progress"}),(0,a.jsx)(u.eb,{value:"done",children:"Done"})]})]}),(0,a.jsxs)(u.l6,{value:N,onValueChange:k,children:[(0,a.jsx)(u.bq,{className:"w-full sm:w-[180px]",children:(0,a.jsx)(u.yv,{placeholder:"Sort by"})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"asc",children:"Oldest First"}),(0,a.jsx)(u.eb,{value:"desc",children:"Newest First"})]})]})]})}),0===_.length?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"all"===C?"You have no tasks assigned to you. Great job!":"No tasks match the current filter."})}):(0,a.jsx)("div",{className:"space-y-4",children:_.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-white border rounded-lg flex flex-col sm:flex-row justify-between items-start gap-4 shadow-sm",children:[(0,a.jsxs)(c(),{href:"/boards/".concat(e.boardId),className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"subtask"===e.type?"Subtask":"Task"})]}),(0,a.jsx)("p",{className:"font-semibold",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["From board: ",(0,a.jsx)("span",{className:"font-medium text-primary",children:e.boardName}),"subtask"===e.type&&(0,a.jsxs)(a.Fragment,{children:[" / Task: ",(0,a.jsx)("span",{className:"font-medium",children:e.taskTitle})]})]}),e.dueDate&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[(0,a.jsx)(g.A,{className:"h-4 w-4"}),"Due: ",(0,w.GP)(e.dueDate.toDate(),"MMM d, yyyy")]})]}),(0,a.jsx)("div",{className:"w-full sm:w-40 flex-shrink-0",children:(0,a.jsxs)(u.l6,{value:e.status,onValueChange:s=>E(e,s),children:[(0,a.jsx)(u.bq,{children:(0,a.jsx)(u.yv,{placeholder:"Change status"})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"todo",children:"To Do"}),(0,a.jsx)(u.eb,{value:"in-progress",children:"In Progress"}),(0,a.jsx)(u.eb,{value:"done",children:"Done"})]})]})})]},"".concat(e.type,"-").concat(e.id)))})]})]})})}},5784:(e,s,t)=>{"use strict";t.d(s,{bq:()=>u,eb:()=>m,gC:()=>x,l6:()=>o,yv:()=>c});var a=t(5155);t(2115);var l=t(8893),r=t(6474),i=t(5196),n=t(7863),d=t(3999);function o(e){let{...s}=e;return(0,a.jsx)(l.bL,{"data-slot":"select",...s})}function c(e){let{...s}=e;return(0,a.jsx)(l.WT,{"data-slot":"select-value",...s})}function u(e){let{className:s,size:t="default",children:i,...n}=e;return(0,a.jsxs)(l.l9,{"data-slot":"select-trigger","data-size":t,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n,children:[i,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(r.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:s,children:t,position:r="popper",...i}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...i,children:[(0,a.jsx)(h,{}),(0,a.jsx)(l.LM,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(p,{})]})})}function m(e){let{className:s,children:t,...r}=e;return(0,a.jsxs)(l.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(i.A,{className:"size-4"})})}),(0,a.jsx)(l.p4,{children:t})]})}function h(e){let{className:s,...t}=e;return(0,a.jsx)(l.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(n.A,{className:"size-4"})})}function p(e){let{className:s,...t}=e;return(0,a.jsx)(l.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(r.A,{className:"size-4"})})}},7550:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7737:(e,s,t)=>{"use strict";t.d(s,{E:()=>r});var a=t(5155);t(2115);var l=t(3999);function r(e){let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md bg-muted",s),...t})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,965,496,395,778,352,563,441,684,358],()=>s(1774)),_N_E=e.O()}]);