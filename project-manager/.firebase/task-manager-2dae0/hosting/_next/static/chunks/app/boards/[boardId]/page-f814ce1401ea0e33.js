(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[508],{2002:(e,s,r)=>{Promise.resolve().then(r.bind(r,5951))},2509:(e,s,r)=>{"use strict";r.d(s,{H:()=>u,t:()=>x});var a=r(5155),t=r(2115),l=r(5317),o=r(8915),i=r(8794),n=r(5695),d=r(6671);let{db:c}=(0,o.M)(),m=(0,t.createContext)(void 0),u=e=>{let{children:s}=e,{user:r}=(0,i.A)(),o=(0,n.useParams)().boardId,[u,x]=(0,t.useState)(null),[h,b]=(0,t.useState)([]),[g,j]=(0,t.useState)({}),[p,f]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{if(!r||!o)return void f(!1);f(!0);let e=[],s=(0,l.aQ)((0,l.H9)(c,"boards",o),e=>{e.exists()?x({id:e.id,...e.data()}):(x(null),d.oR.error("Board not found.")),f(!1)},e=>{console.error("Firestore board listener error:",e),d.oR.error("Failed to load board.",{description:"You may not have permission to view this board."}),x(null),f(!1)});e.push(s);let a=(0,l.P)((0,l.rJ)(c,"boards",o,"tasks")),t=(0,l.aQ)(a,e=>{b(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Firestore tasks listener error:",e),d.oR.error("Failed to load tasks for this board."),b([])});return e.push(t),()=>e.forEach(e=>e())},[r,o]),(0,t.useEffect)(()=>{if(0===h.length)return;let e=[];return j({}),h.forEach(s=>{let r=(0,l.P)((0,l.rJ)(c,"boards",o,"tasks",s.id,"subtasks")),a=(0,l.aQ)(r,e=>{let r=e.docs.map(e=>({id:e.id,...e.data()}));j(e=>({...e,[s.id]:r}))},e=>{console.error("Firestore subtasks listener error for task ".concat(s.id,":"),e),d.oR.error("Failed to load subtasks for task: ".concat(s.title))});e.push(a)}),()=>e.forEach(e=>e())},[h,o]),(0,a.jsx)(m.Provider,{value:{board:u,tasks:h,subtasks:g,loading:p},children:s})},x=()=>{let e=(0,t.useContext)(m);if(void 0===e)throw Error("useRealtimeData must be used within a RealtimeDataProvider");return e}},5951:(e,s,r)=>{"use strict";r.d(s,{default:()=>eC});var a=r(5155),t=r(2115),l=r(5695),o=r(5317),i=r(8915),n=r(8794),d=r(2509),c=r(7168),m=r(6874),u=r.n(m),x=r(8145),h=r(3008),b=r(1362),g=r(4186),j=r(5339),p=r(3453),f=r(4395),N=r(7580),w=r(9074),v=r(4616),y=r(2318),k=r(381),A=r(1007),S=r(6785),C=r(2417),D=r(5968),E=r(9917),T=r(4126),R=r(6474),M=r(9840),I=r(4844),B=r(6042),P=r(1926),z=r(221),U=r(2177),F=r(1153),$=r(70),L=r(9852),O=r(6671),G=r(8883),K=r(1154);let{db:H}=(0,i.M)(),_=F.z.object({email:F.z.string().email("Invalid email address")});function J(e){let{boardId:s,onInviteSent:r,onClose:l}=e,[i,d]=(0,t.useState)(!1),{user:m}=(0,n.A)(),u=(0,U.mN)({resolver:(0,z.u)(_),defaultValues:{email:""}}),x=async e=>{d(!0);try{var a;if(console.log("\uD83D\uDD0D Starting invite process..."),console.log("\uD83D\uDCE7 Email to invite:",e.email),console.log("\uD83C\uDFC1 Board ID:",s),console.log("\uD83D\uDC64 Current user:",null==m?void 0:m.uid,null==m?void 0:m.email),!m){console.error("❌ User not authenticated"),O.oR.error("Authentication error",{description:"You must be logged in to invite members."});return}console.log("\uD83D\uDD0D Checking board access...");let t=(0,o.H9)(H,"boards",s),i=await (0,o.x7)(t);if(!i.exists()){console.error("❌ Board does not exist"),O.oR.error("Board not found");return}let n=i.data();console.log("\uD83D\uDCCB Board data:",n),console.log("\uD83D\uDC65 Current members:",n.members),console.log("\uD83D\uDC51 Board owner:",n.owner),console.log("\uD83D\uDD0D Searching for user by email...");let d=(0,o.rJ)(H,"users"),c=(0,o.P)(d,(0,o._M)("email","==",e.email)),u=await (0,o.GG)(c);if(u.empty){console.error("❌ User not found in database"),O.oR.error("User not found",{description:"No user found with this email address. They need to create an account first."});return}let x=u.docs[0],h=x.id,b=x.data();if(console.log("✅ Found user:",h,b),null==(a=n.members)?void 0:a.includes(h)){console.log("ℹ️ User is already a member"),O.oR.error("User is already a member of this board");return}console.log("\uD83D\uDD04 Adding user to board members..."),await (0,o.mZ)(t,{members:(0,o.hq)(h)}),console.log("✅ Successfully added user to board"),O.oR.success("".concat(e.email," has been added to the board!")),r(),l()}catch(e){console.error("❌ Error inviting user: ",e),e instanceof Error?(console.error("Error name:",e.name),console.error("Error message:",e.message),console.error("Error stack:",e.stack),O.oR.error("Failed to invite user.",{description:e.message})):(console.error("Unknown error type:",typeof e,e),O.oR.error("An unknown error occurred while inviting the user."))}finally{d(!1)}};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 to-purple-50/50 rounded-xl -z-10"}),(0,a.jsx)($.lV,{...u,children:(0,a.jsxs)("form",{onSubmit:u.handleSubmit(x),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center shadow-lg",children:(0,a.jsx)(y.A,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Invite Member"})]}),(0,a.jsx)($.zB,{control:u.control,name:"email",render:e=>{let{field:s}=e;return(0,a.jsxs)($.eI,{children:[(0,a.jsx)($.lR,{className:"text-sm font-medium text-gray-700",children:"Email Address"}),(0,a.jsx)($.MJ,{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(G.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)(L.p,{type:"email",placeholder:"Enter email to invite",...s,className:"pl-10 backdrop-blur-sm bg-white/80 border-white/20 focus:border-blue-300 focus:ring-2 focus:ring-blue-200/50 transition-all duration-200"})]})}),(0,a.jsx)($.C5,{})]})}}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(c.$,{type:"button",variant:"outline",onClick:l,className:"backdrop-blur-sm bg-white/50 border-white/20 hover:bg-white/70 transition-all duration-200",children:"Cancel"}),(0,a.jsx)(c.$,{type:"submit",disabled:i,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Adding..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"Add to Board"]})})]})]})})]})}var Z=r(9663),q=r(7951),Q=r(5494),V=r(6559);let{db:W}=(0,i.M)(),Y=e=>{let{isOpen:s,onClose:r,boardId:l,isOwner:i}=e,[n,d]=(0,t.useState)([]),[m,u]=(0,t.useState)(null),[h,b]=(0,t.useState)(!1),[g,j]=(0,t.useState)(null),p=(0,t.useCallback)(async()=>{if(s){b(!0);try{let e=await (0,o.x7)((0,o.H9)(W,"boards",l));if(!e.exists())return void O.oR.error("Board not found.");let s=e.data(),r=s.members||[],a=s.owner,t=r.map(async e=>{let s=await (0,o.x7)((0,o.H9)(W,"users",e));if(s.exists()){let r=s.data();return{uid:e,email:r.email,displayName:r.displayName,photoURL:r.photoURL}}return null}),i=(await Promise.all(t)).filter(e=>null!==e),n=await (0,o.x7)((0,o.H9)(W,"users",a));if(n.exists()){let e=n.data();u({uid:a,email:e.email,displayName:e.displayName,photoURL:e.photoURL})}d(i)}catch(e){console.error("Error fetching board members:",e),O.oR.error("Failed to fetch members.")}finally{b(!1)}}},[s,l]);(0,t.useEffect)(()=>{p()},[p]);let f=async()=>{if(g)try{let e=(0,o.H9)(W,"boards",l);await (0,o.mZ)(e,{members:(0,o.C3)(g.uid)}),O.oR.success("Removed ".concat(g.displayName||g.email," from the board.")),j(null),p()}catch(e){console.error("Error removing member:",e),e instanceof Error?O.oR.error("Failed to remove member.",{description:e.message}):O.oR.error("An unknown error occurred while removing the member.")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(M.lG,{open:s,onOpenChange:r,children:(0,a.jsxs)(M.Cf,{className:"backdrop-blur-sm bg-white/95 border-0 shadow-2xl max-w-md",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white/40 to-white/10 rounded-lg"}),(0,a.jsx)(M.c7,{className:"relative",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,a.jsx)(N.A,{className:"w-5 h-5 text-white"})}),(0,a.jsx)(M.L3,{className:"text-xl font-semibold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Manage Board Members"})]})}),(0,a.jsx)("div",{className:"relative",children:h?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 text-gray-600",children:[(0,a.jsx)(K.A,{className:"w-5 h-5 animate-spin"}),(0,a.jsx)("span",{children:"Loading members..."})]})}):(0,a.jsxs)("div",{className:"space-y-3",children:[n.map(e=>{var s,r,t,l,o,n,d;return(0,a.jsx)("div",{className:"backdrop-blur-sm bg-white/60 rounded-xl p-4 border border-white/30 hover:bg-white/70 transition-all duration-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(Z.eu,{className:"h-10 w-10 border-2 border-white shadow-md",children:[(0,a.jsx)(Z.BK,{src:null!=(l=e.photoURL)?l:void 0,alt:null!=(o=e.displayName)?o:e.email}),(0,a.jsx)(Z.q5,{className:"bg-gradient-to-br from-gray-100 to-gray-200 text-sm font-medium",children:null!=(n=null==(s=e.displayName)?void 0:s.charAt(0))?n:null==(t=e.email)||null==(r=t.charAt(0))?void 0:r.toUpperCase()})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:null!=(d=e.displayName)?d:"No Name"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.email})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:e.uid===(null==m?void 0:m.uid)?(0,a.jsxs)(x.E,{className:"bg-gradient-to-r from-yellow-500 to-orange-600 text-white border-0 shadow-md",children:[(0,a.jsx)(q.A,{className:"w-3 h-3 mr-1"}),"Owner"]}):i?(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>j(e),className:"backdrop-blur-sm bg-red-500/10 border-red-200/20 hover:bg-red-500/20 text-red-600 transition-all duration-200",children:[(0,a.jsx)(Q.A,{className:"w-4 h-4 mr-1"}),"Remove"]}):(0,a.jsx)(x.E,{variant:"secondary",className:"bg-white/50 text-gray-600",children:"Member"})})]})},e.uid)}),0===n.length&&(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-gray-400 to-gray-500 rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)(N.A,{className:"w-6 h-6 text-white"})}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"No members found"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Invite members to collaborate on this board"})]})]})})]})}),g&&(0,a.jsx)(V.Lt,{open:!!g,onOpenChange:e=>!e&&j(null),children:(0,a.jsxs)(V.EO,{children:[(0,a.jsxs)(V.wd,{children:[(0,a.jsx)(V.r7,{children:"Are you sure?"}),(0,a.jsxs)(V.$v,{children:["This will permanently remove ",(0,a.jsx)("strong",{children:g.displayName||g.email})," from the board."]})]}),(0,a.jsxs)(V.ck,{children:[(0,a.jsx)(V.Zr,{children:"Cancel"}),(0,a.jsx)(V.Rx,{onClick:f,children:"Confirm"})]})]})})]})};var X=r(7737);let ee=()=>(0,a.jsxs)("div",{className:"container mx-auto py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(X.E,{className:"h-9 w-64 mb-2"}),(0,a.jsx)(X.E,{className:"h-5 w-80"})]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-shrink-0",children:[(0,a.jsx)(X.E,{className:"h-10 w-24"}),(0,a.jsx)(X.E,{className:"h-10 w-28"}),(0,a.jsx)(X.E,{className:"h-10 w-24"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4 mt-8",children:"Tasks"}),Array.from({length:2}).map((e,s)=>(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(X.E,{className:"h-10 w-10"}),(0,a.jsx)(X.E,{className:"h-7 w-48"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(X.E,{className:"h-6 w-16"}),(0,a.jsx)(X.E,{className:"h-9 w-24"}),(0,a.jsx)(X.E,{className:"h-9 w-32"}),(0,a.jsx)(X.E,{className:"h-9 w-28"})]})]}),(0,a.jsx)(X.E,{className:"h-4 w-3/4 mt-1 mb-4 ml-12"}),(0,a.jsx)("div",{className:"ml-8 mt-4 space-y-2",children:Array.from({length:3}).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(X.E,{className:"h-6 w-6 rounded-full"}),(0,a.jsx)(X.E,{className:"h-5 w-56"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(X.E,{className:"h-5 w-20"}),(0,a.jsx)(X.E,{className:"h-8 w-8"}),(0,a.jsx)(X.E,{className:"h-8 w-8"})]})]},s))})]},s))]})]});var es=r(9474),er=r(823),ea=r(6894),et=r(5784),el=r(3999),eo=r(4992);let{db:ei}=(0,i.M)(),en=F.z.object({title:F.z.string().min(1,"Title is required"),description:F.z.string().optional(),dueDate:F.z.date().optional(),status:F.z.string(),assignedTo:F.z.string().optional(),remark:F.z.string().optional()});function ed(e){var s;let{boardId:r,boardMembers:i,boardStatuses:d,onTaskCreated:m,onClose:u}=e,{user:x}=(0,n.A)(),b=(0,l.useRouter)(),[g,j]=(0,t.useState)(!1),p=(0,U.mN)({resolver:(0,z.u)(en),defaultValues:{title:"",description:"",status:(null==(s=d[0])?void 0:s.id)||"todo",assignedTo:void 0,remark:""}}),f=async e=>{if(!x){O.oR.error("You must be logged in to create a task."),b.push("/login");return}j(!0);try{await (0,o.gS)((0,o.rJ)(ei,"boards",r,"tasks"),{boardId:r,title:e.title,description:e.description||"",status:e.status,dueDate:e.dueDate?o.Dc.fromDate(e.dueDate):null,assignedTo:e.assignedTo||null,remark:e.remark||"",createdAt:o.Dc.now(),owner:x.uid}),m(),u()}catch(e){console.error("Error creating task: ",e),O.oR.error("Failed to create task. Please try again.")}finally{j(!1)}};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 to-purple-50/50 rounded-xl -z-10"}),(0,a.jsx)($.lV,{...p,children:(0,a.jsxs)("form",{onSubmit:p.handleSubmit(f),className:"space-y-6",children:[(0,a.jsx)($.zB,{control:p.control,name:"title",render:e=>{let{field:s}=e;return(0,a.jsxs)($.eI,{children:[(0,a.jsx)($.lR,{className:"text-sm font-medium text-gray-700",children:"Title"}),(0,a.jsx)($.MJ,{children:(0,a.jsx)(L.p,{placeholder:"Task title",...s,className:"backdrop-blur-sm bg-white/80 border-white/20 focus:border-blue-300 focus:ring-2 focus:ring-blue-200/50 transition-all duration-200"})}),(0,a.jsx)($.C5,{})]})}}),(0,a.jsx)($.zB,{control:p.control,name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)($.eI,{children:[(0,a.jsx)($.lR,{className:"text-sm font-medium text-gray-700",children:"Description"}),(0,a.jsx)($.MJ,{children:(0,a.jsx)(es.T,{placeholder:"Task description",...s,className:"backdrop-blur-sm bg-white/80 border-white/20 focus:border-blue-300 focus:ring-2 focus:ring-blue-200/50 transition-all duration-200 min-h-[80px]"})}),(0,a.jsx)($.C5,{})]})}}),(0,a.jsx)($.zB,{control:p.control,name:"dueDate",render:e=>{let{field:s}=e;return(0,a.jsxs)($.eI,{className:"flex flex-col",children:[(0,a.jsx)($.lR,{className:"text-sm font-medium text-gray-700",children:"Due Date"}),(0,a.jsxs)(er.AM,{children:[(0,a.jsx)(er.Wv,{asChild:!0,children:(0,a.jsx)($.MJ,{children:(0,a.jsxs)(c.$,{variant:"outline",className:(0,el.cn)("w-full justify-start text-left font-normal backdrop-blur-sm bg-white/80 border-white/20 hover:bg-white/90 focus:border-blue-300 focus:ring-2 focus:ring-blue-200/50 transition-all duration-200",!s.value&&"text-gray-500"),children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"}),s.value?(0,h.GP)(s.value,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})})}),(0,a.jsx)(er.hl,{className:"w-auto p-0 backdrop-blur-sm bg-white/95 border-white/20",align:"start",children:(0,a.jsx)(ea.V,{mode:"single",selected:s.value,onSelect:s.onChange,disabled:e=>e<new Date("1900-01-01"),initialFocus:!0})})]}),(0,a.jsx)($.C5,{})]})}}),(0,a.jsx)($.zB,{control:p.control,name:"status",render:e=>{let{field:s}=e;return(0,a.jsxs)($.eI,{children:[(0,a.jsx)($.lR,{className:"text-sm font-medium text-gray-700",children:"Status"}),(0,a.jsxs)(et.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,a.jsx)($.MJ,{children:(0,a.jsx)(et.bq,{className:"backdrop-blur-sm bg-white/80 border-white/20 focus:border-blue-300 focus:ring-2 focus:ring-blue-200/50 transition-all duration-200",children:(0,a.jsx)(et.yv,{placeholder:"Select a status"})})}),(0,a.jsx)(et.gC,{className:"backdrop-blur-sm bg-white/95 border-white/20",children:d.map(e=>(0,a.jsx)(et.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-gradient-to-r ".concat(e.color)}),e.name]})},e.id))})]}),(0,a.jsx)($.C5,{})]})}}),(0,a.jsx)($.zB,{control:p.control,name:"assignedTo",render:e=>{let{field:s}=e;return(0,a.jsxs)($.eI,{children:[(0,a.jsx)($.lR,{className:"text-sm font-medium text-gray-700",children:"Assign To"}),(0,a.jsx)($.MJ,{children:(0,a.jsx)(eo._,{selectedMemberId:s.value,boardMembers:i,onSelect:s.onChange,placeholder:"Assign to member"})}),(0,a.jsx)($.C5,{})]})}}),(0,a.jsx)($.zB,{control:p.control,name:"remark",render:e=>{let{field:s}=e;return(0,a.jsxs)($.eI,{children:[(0,a.jsx)($.lR,{className:"text-sm font-medium text-gray-700",children:"Remark / Notes"}),(0,a.jsx)($.MJ,{children:(0,a.jsx)(es.T,{placeholder:"Add any additional notes or comments...",...s,className:"backdrop-blur-sm bg-white/80 border-white/20 focus:border-blue-300 focus:ring-2 focus:ring-blue-200/50 transition-all duration-200 min-h-[80px]",rows:3})}),(0,a.jsx)($.C5,{})]})}}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)(c.$,{type:"button",variant:"outline",onClick:u,className:"backdrop-blur-sm bg-white/50 border-white/20 hover:bg-white/70 transition-all duration-200",children:"Cancel"}),(0,a.jsx)(c.$,{type:"submit",disabled:g,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"Create Task"]})})]})]})})]})}var ec=r(4378),em=r(4156),eu=r(8482),ex=r(8250),eh=r(1609),eb=r(9918),eg=r(8236),ej=r(5623),ep=r(7133);let{db:ef}=(0,i.M)(),eN=[{id:"todo",name:"To Do",color:"from-yellow-500 to-orange-600",order:1},{id:"in-progress",name:"In Progress",color:"from-blue-500 to-cyan-600",order:2},{id:"done",name:"Done",color:"from-green-500 to-emerald-600",order:3}],ew={TASK:"task",SUBTASK:"subtask"},ev=e=>{let{boardId:s,task:r,subtasks:t,boardMembers:l,onEditTask:o,onDeleteTask:i,onEditSubtask:n,onDeleteSubtask:d,onAddSubtask:m}=e,[{isDragging:x},b]=(0,ex.i)({type:ew.TASK,item:{type:ew.TASK,id:r.id,status:r.status},collect:e=>({isDragging:!!e.isDragging()})}),f=(e=>{switch(e){case"todo":return{icon:j.A,color:"from-yellow-500 to-orange-600"};case"in-progress":return{icon:g.A,color:"from-blue-500 to-cyan-600"};case"done":return{icon:p.A,color:"from-green-500 to-emerald-600"};default:return{icon:j.A,color:"from-gray-500 to-gray-600"}}})(r.status);return(0,a.jsxs)(eu.Zp,{ref:b,className:"mb-3 cursor-move transition-all duration-200 hover:shadow-lg ".concat(x?"opacity-50 rotate-2 scale-105":"opacity-100"," backdrop-blur-sm bg-white/90 border-0 shadow-md"),children:[(0,a.jsx)(eu.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br ".concat(f.color," rounded-lg flex items-center justify-center shadow-sm flex-shrink-0"),children:(0,a.jsx)(f.icon,{className:"w-4 h-4 text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)(u(),{href:"/boards/".concat(s,"/tasks/").concat(r.id),className:"font-semibold text-gray-900 mb-1 line-clamp-2 text-sm hover:text-blue-600 transition-colors cursor-pointer block",children:r.title}),r.description&&(0,a.jsx)("p",{className:"text-xs text-gray-600 line-clamp-2 mb-2",children:r.description})]})]}),(0,a.jsxs)(ep.rI,{children:[(0,a.jsx)(ep.ty,{asChild:!0,children:(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-6 w-6 flex-shrink-0",children:(0,a.jsx)(ej.A,{className:"h-3 w-3"})})}),(0,a.jsxs)(ep.SQ,{align:"end",children:[(0,a.jsxs)(ep._2,{onClick:()=>o(r),children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,a.jsxs)(ep._2,{onClick:()=>m(r.id),children:[(0,a.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Add Subtask"]}),(0,a.jsxs)(ep._2,{onClick:()=>i(r),className:"text-red-600 focus:text-red-600",children:[(0,a.jsx)(T.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})}),(0,a.jsx)(eu.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[r.dueDate&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,a.jsx)(w.A,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:["Due ",(0,h.GP)(r.dueDate.toDate(),"MMM d")]})]}),r.assignedTo&&(()=>{var e,s,t;let o=l.find(e=>e.uid===r.assignedTo);return o?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)(Z.eu,{className:"h-5 w-5 border border-white",children:[(0,a.jsx)(Z.BK,{src:o.photoURL||void 0}),(0,a.jsx)(Z.q5,{className:"text-[10px] bg-gradient-to-br from-blue-100 to-purple-100",children:(null==(e=o.displayName)?void 0:e[0])||(null==(t=o.email)||null==(s=t[0])?void 0:s.toUpperCase())})]}),(0,a.jsx)("span",{className:"text-xs text-gray-600 font-medium",children:o.displayName||o.email})]}):null})()]}),t&&t.length>0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,a.jsx)("span",{children:"Subtasks"}),(0,a.jsxs)("span",{children:[t.filter(e=>"done"===e.status).length,"/",t.length]})]}),t.slice(0,3).map(e=>(0,a.jsx)(ey,{subtask:e,task:r,boardMembers:l,onEditSubtask:n,onDeleteSubtask:d},e.id)),t.length>3&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",t.length-3," more subtasks"]})]})]})})]})},ey=e=>{var s,r,t;let{subtask:l,task:o,boardMembers:i,onEditSubtask:n,onDeleteSubtask:d}=e,[{isDragging:m},u]=(0,ex.i)({type:ew.SUBTASK,item:{type:ew.SUBTASK,id:l.id,status:l.status,taskId:o.id},collect:e=>({isDragging:!!e.isDragging()})}),x=i.find(e=>e.uid===l.assignedTo),b=(e=>{switch(e){case"todo":return{icon:j.A,color:"from-yellow-500 to-orange-600"};case"in-progress":return{icon:g.A,color:"from-blue-500 to-cyan-600"};case"done":return{icon:p.A,color:"from-green-500 to-emerald-600"};default:return{icon:j.A,color:"from-gray-500 to-gray-600"}}})(l.status);return(0,a.jsxs)("div",{ref:u,className:"flex items-center justify-between gap-2 p-2 rounded-lg bg-gray-50/80 hover:bg-gray-100/80 transition-all duration-200 cursor-move ".concat(m?"opacity-50":"opacity-100"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-gradient-to-br ".concat(b.color," rounded flex items-center justify-center flex-shrink-0"),children:(0,a.jsx)(b.icon,{className:"w-2.5 h-2.5 text-white"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-900 truncate block",children:l.title}),l.dueDate&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-gray-500 mt-0.5",children:[(0,a.jsx)(w.A,{className:"w-2 h-2"}),(0,a.jsxs)("span",{children:["Due ",(0,h.GP)(l.dueDate.toDate(),"MMM d")]})]})]}),x&&(0,a.jsxs)(Z.eu,{className:"h-4 w-4 border border-white flex-shrink-0",children:[(0,a.jsx)(Z.BK,{src:x.photoURL||void 0}),(0,a.jsx)(Z.q5,{className:"text-[8px] bg-gradient-to-br from-gray-100 to-gray-200",children:(null==(s=x.displayName)?void 0:s[0])||(null==(t=x.email)||null==(r=t[0])?void 0:r.toUpperCase())})]})]}),(0,a.jsxs)(ep.rI,{children:[(0,a.jsx)(ep.ty,{asChild:!0,children:(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-5 w-5 flex-shrink-0",children:(0,a.jsx)(ej.A,{className:"h-2.5 w-2.5"})})}),(0,a.jsxs)(ep.SQ,{align:"end",children:[(0,a.jsxs)(ep._2,{onClick:()=>n(o,l),children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-2"}),"Edit"]}),(0,a.jsxs)(ep._2,{onClick:()=>d(o,l),className:"text-red-600 focus:text-red-600",children:[(0,a.jsx)(T.A,{className:"h-3 w-3 mr-2"}),"Delete"]})]})]})]})},ek=e=>{let{boardId:s,status:r,tasks:t,subtasks:l,boardMembers:o,onEditTask:i,onDeleteTask:n,onEditSubtask:d,onDeleteSubtask:c,onAddSubtask:m,onDropTask:u,onDropSubtask:h}=e,[{isOver:b,canDrop:g},j]=(0,eh.H)({accept:[ew.TASK,ew.SUBTASK],drop:e=>{e.status!==r.id&&(e.type===ew.TASK?u(e.id,r.id):e.type===ew.SUBTASK&&e.taskId&&h(e.id,e.taskId,r.id))},collect:e=>({isOver:!!e.isOver(),canDrop:!!e.canDrop()})}),p=t.filter(e=>e.status===r.id);return(0,a.jsx)("div",{ref:j,className:"flex-1 min-w-80 max-w-sm transition-all duration-200 ".concat(b&&g?"bg-blue-50/50 scale-105":""),children:(0,a.jsxs)(eu.Zp,{className:"h-full backdrop-blur-sm bg-white/60 border-0 shadow-lg",children:[(0,a.jsx)(eu.aR,{className:"pb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br ".concat(r.color," rounded-lg flex items-center justify-center shadow-sm"),children:(0,a.jsx)("div",{className:"w-3 h-3 bg-white rounded-full"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:r.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[p.length," tasks"]})]})]}),(0,a.jsx)(x.E,{variant:"secondary",className:"bg-gray-100 text-gray-600",children:p.length})]})}),(0,a.jsx)(eu.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"space-y-3 min-h-96",children:[p.map(e=>(0,a.jsx)(ev,{boardId:s,task:e,subtasks:l[e.id]||[],boardMembers:o,onEditTask:i,onDeleteTask:n,onEditSubtask:d,onDeleteSubtask:c,onAddSubtask:m},e.id)),0===p.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-lg mx-auto mb-3 flex items-center justify-center",children:(0,a.jsx)(v.A,{className:"w-6 h-6 text-gray-400"})}),(0,a.jsx)("p",{className:"text-sm",children:"No tasks yet"}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Drag tasks here"})]}),b&&g&&(0,a.jsx)("div",{className:"border-2 border-dashed border-blue-300 rounded-lg p-4 text-center text-blue-600 bg-blue-50/50",children:"Drop here"})]})})]})})},eA=e=>{let{boardId:s,board:r,tasks:l,subtasks:i,boardMembers:n,onEditTask:d,onDeleteTask:c,onEditSubtask:m,onDeleteSubtask:u,onAddSubtask:x}=e,h=(0,t.useCallback)(async(e,r)=>{try{let a=(0,o.H9)(ef,"boards",s,"tasks",e);await (0,o.mZ)(a,{status:r}),O.oR.success("Task moved successfully!")}catch(e){console.error("Error updating task status:",e),O.oR.error("Failed to move task")}},[s]),b=(0,t.useCallback)(async(e,r,a)=>{try{let t=(0,o.H9)(ef,"boards",s,"tasks",r,"subtasks",e);await (0,o.mZ)(t,{status:a}),O.oR.success("Subtask moved successfully!")}catch(e){console.error("Error updating subtask status:",e),O.oR.error("Failed to move subtask")}},[s]),g=r.customStatuses&&r.customStatuses.length>0?r.customStatuses.sort((e,s)=>e.order-s.order):eN;return(0,a.jsx)(eb.Q,{backend:eg.t2,children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("div",{className:"flex gap-6 overflow-x-auto pb-6",children:g.map(e=>(0,a.jsx)(ek,{boardId:s,status:e,tasks:l,subtasks:i,boardMembers:n,onEditTask:d,onDeleteTask:c,onEditSubtask:m,onDeleteSubtask:u,onAddSubtask:x,onDropTask:h,onDropSubtask:b},e.id))})})})},{db:eS}=(0,i.M)(),eC=()=>{let e=(0,l.useRouter)(),{boardId:s}=(0,l.useParams)(),{user:r}=(0,n.A)(),{board:i,tasks:m,subtasks:z,loading:U}=(0,d.t)(),[F,$]=(0,t.useState)({}),[L,G]=(0,t.useState)({}),[K,H]=(0,t.useState)(null),[_,q]=(0,t.useState)(null),[Q,V]=(0,t.useState)(null),[W,X]=(0,t.useState)(null),[es,er]=(0,t.useState)(!1),[ea,et]=(0,t.useState)(!1),[el,eo]=(0,t.useState)(!1),[ei,en]=(0,t.useState)("board"),[ex,eh]=(0,t.useState)([]),eb=(0,t.useCallback)(async()=>{if(i)try{let e=i.members.map(async e=>{let s=await (0,o.x7)((0,o.H9)(eS,"users",e));if(s.exists()){let r=s.data();return{uid:e,email:r.email,displayName:r.displayName,photoURL:r.photoURL}}return null}),s=await Promise.all(e);eh(s.filter(e=>null!==e))}catch(e){console.error("Error fetching board members:",e)}},[i]);(0,t.useEffect)(()=>{i&&eb()},[i,s,eb]),(0,t.useEffect)(()=>{U||i||(O.oR.error("Board not found or you don't have access."),e.push("/dashboard"))},[U,i,e]);let eg=()=>{O.oR.success("Subtask created!")},ej=async()=>{if(Q)try{let e=(0,o.wP)(eS);for(let r of z[Q.id]||[]){let a=(0,o.H9)(eS,"boards",s,"tasks",Q.id,"subtasks",r.id);e.delete(a)}let r=(0,o.H9)(eS,"boards",s,"tasks",Q.id);e.delete(r),await e.commit(),V(null),O.oR.success("Task and its subtasks deleted successfully!")}catch(e){console.error("Error deleting task: ",e),O.oR.error("Failed to delete task.")}},ep=async()=>{if(W)try{let e=(0,o.H9)(eS,"boards",s,"tasks",W.task.id,"subtasks",W.subtask.id);await (0,o.kd)(e),X(null),O.oR.success("Subtask deleted successfully!")}catch(e){console.error("Error deleting subtask: ",e),O.oR.error("Failed to delete subtask.")}},ef=e=>{$(s=>({...s,[e]:!s[e]}))},eN=e=>{G(s=>({...s,[e]:!s[e]}))};if(U)return(0,a.jsx)(ee,{});if(!i)return(0,a.jsx)("div",{className:"container mx-auto py-8",children:"Board not found or you do not have access."});let ew=r&&r.uid===i.owner,ev=e=>{switch(e){case"todo":default:return"secondary";case"in-progress":return"default";case"done":return"outline"}},ey=e=>{switch(e){case"todo":default:return(0,a.jsx)(g.A,{className:"w-4 h-4"});case"in-progress":return(0,a.jsx)(j.A,{className:"w-4 h-4"});case"done":return(0,a.jsx)(p.A,{className:"w-4 h-4"})}};return(0,a.jsx)(em.q,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,a.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-blue-400/10 to-purple-600/10 rounded-full blur-3xl"}),(0,a.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-br from-indigo-400/10 to-pink-600/10 rounded-full blur-3xl"}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 w-96 h-96 bg-gradient-to-br from-cyan-400/5 to-blue-600/5 rounded-full blur-3xl transform -translate-x-1/2 -translate-y-1/2"})]}),(0,a.jsx)(ec.Y,{}),(0,a.jsxs)("div",{className:"relative container mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)(eu.Zp,{className:"backdrop-blur-sm bg-white/70 border-0 shadow-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white/40 to-white/10"}),(0,a.jsxs)(eu.Wu,{className:"relative p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,a.jsx)(f.A,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent mb-2",children:i.name}),(0,a.jsx)("p",{className:"text-gray-600 text-lg max-w-2xl",children:i.description||"No description provided"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[ex.length," member",1!==ex.length?"s":""]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,a.jsx)(w.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Created ",i.createdAt?(0,h.GP)(new Date(1e3*i.createdAt.seconds),"MMM d, yyyy"):"Unknown"]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsxs)(c.$,{onClick:()=>eo(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg",children:[(0,a.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"Add Task"]}),(0,a.jsxs)(c.$,{variant:"outline",onClick:()=>er(!0),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80",children:[(0,a.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"Invite Member"]}),(0,a.jsxs)(c.$,{variant:"outline",onClick:()=>et(!0),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80",children:[(0,a.jsx)(N.A,{className:"w-4 h-4 mr-2"}),"Members"]}),(0,a.jsx)(c.$,{variant:"outline",asChild:!0,className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80",children:(0,a.jsxs)(u(),{href:"/boards/".concat(s,"/edit"),children:[(0,a.jsx)(k.A,{className:"w-4 h-4 mr-2"}),"Settings"]})})]})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(A.A,{className:"w-4 h-4 text-gray-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Board Members"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:ex.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/60 backdrop-blur-sm border border-gray-200",children:[(0,a.jsxs)(Z.eu,{className:"w-6 h-6",children:[(0,a.jsx)(Z.BK,{src:e.photoURL||void 0,alt:e.displayName||e.email}),(0,a.jsx)(Z.q5,{className:"text-xs bg-gradient-to-br from-blue-600 to-purple-600 text-white",children:(e.displayName||e.email).charAt(0).toUpperCase()})]}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.displayName||e.email}),e.uid===i.owner&&(0,a.jsx)(x.E,{variant:"secondary",className:"text-xs bg-gradient-to-r from-amber-100 to-orange-100 text-amber-800 border-0",children:"Owner"})]},e.uid))})]})]})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:["Tasks (",m.length,")"]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,a.jsx)(S.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[m.filter(e=>"done"===e.status).length," completed"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 p-1 bg-white/60 backdrop-blur-sm rounded-lg border border-gray-200",children:[(0,a.jsxs)(c.$,{variant:"board"===ei?"default":"ghost",size:"sm",onClick:()=>en("board"),className:"h-8 px-3",children:[(0,a.jsx)(C.A,{className:"w-4 h-4 mr-1"}),"Board"]}),(0,a.jsxs)(c.$,{variant:"list"===ei?"default":"ghost",size:"sm",onClick:()=>en("list"),className:"h-8 px-3",children:[(0,a.jsx)(D.A,{className:"w-4 h-4 mr-1"}),"List"]})]})]})]}),0===m.length?(0,a.jsx)(eu.Zp,{className:"backdrop-blur-sm bg-white/60 border-0 shadow-lg",children:(0,a.jsxs)(eu.Wu,{className:"p-12 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full mx-auto mb-4 flex items-center justify-center",children:(0,a.jsx)(S.A,{className:"w-8 h-8 text-gray-500"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No tasks yet"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Get started by creating your first task for this board."}),(0,a.jsxs)(c.$,{onClick:()=>eo(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg",children:[(0,a.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"Create First Task"]})]})}):"board"===ei?(0,a.jsx)(eA,{boardId:s,board:i,tasks:m,subtasks:z,boardMembers:ex,onEditTask:H,onDeleteTask:V,onEditSubtask:(e,s)=>q({task:e,subtask:s}),onDeleteSubtask:(e,s)=>X({task:e,subtask:s}),onAddSubtask:e=>{ef(e)}}):(0,a.jsx)("div",{className:"space-y-4",children:m.map(e=>(0,a.jsxs)(eu.Zp,{className:"backdrop-blur-sm bg-white/70 border-0 shadow-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white/50 to-white/20"}),(0,a.jsxs)(eu.Wu,{className:"relative p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(u(),{href:"/boards/".concat(s,"/tasks/").concat(e.id),className:"text-xl font-semibold text-gray-900 hover:text-blue-600 transition-colors cursor-pointer",children:e.title}),(0,a.jsxs)(x.E,{variant:ev(e.status),className:"flex items-center gap-1",children:[ey(e.status),e.status]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 leading-relaxed",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Created ",(0,h.GP)(new Date(1e3*e.createdAt.seconds),"MMM d, yyyy")]})]}),e.dueDate&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Due ",(0,h.GP)(new Date(1e3*e.dueDate.seconds),"MMM d, yyyy")]})]}),e.assignedTo&&(()=>{let s=ex.find(s=>s.uid===e.assignedTo);return s?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Assigned to ",s.displayName||s.email]})]}):null})(),e.assignedTo&&(()=>{let s=ex.find(s=>s.uid===e.assignedTo);return s?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Assigned to ",s.displayName||s.email]})]}):null})(),z[e.id]&&z[e.id].length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[z[e.id].filter(e=>"done"===e.status).length,"/",z[e.id].length," subtasks"]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,a.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>H(e),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80",children:(0,a.jsx)(E.A,{className:"w-4 h-4"})}),(0,a.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>V(e),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80 hover:border-red-300 hover:text-red-600",children:(0,a.jsx)(T.A,{className:"w-4 h-4"})}),(0,a.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>eN(e.id),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80",children:(0,a.jsx)(R.A,{className:"w-4 h-4 transition-transform ".concat(L[e.id]?"transform rotate-180":"")})})]})]}),L[e.id]&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-200/60",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:"Subtasks"}),(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>ef(e.id),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80",children:[(0,a.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"Add Subtask"]})]}),F[e.id]&&(0,a.jsx)("div",{className:"p-4 rounded-lg bg-white/60 backdrop-blur-sm border border-gray-200",children:(0,a.jsx)(b.m,{boardId:s,taskId:e.id,boardMembers:ex,boardStatuses:(null==i?void 0:i.customStatuses)&&i.customStatuses.length>0?i.customStatuses:[{id:"todo",name:"To Do",color:"from-yellow-500 to-orange-600",order:1},{id:"in-progress",name:"In Progress",color:"from-blue-500 to-cyan-600",order:2},{id:"done",name:"Done",color:"from-green-500 to-emerald-600",order:3}],onSubtaskCreated:eg,onClose:()=>ef(e.id)})}),z[e.id]&&z[e.id].length>0?(0,a.jsx)("div",{className:"space-y-3",children:z[e.id].map(s=>(0,a.jsx)("div",{className:"p-4 rounded-lg bg-white/50 backdrop-blur-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("h5",{className:"font-medium text-gray-900",children:s.title}),(0,a.jsxs)(x.E,{variant:ev(s.status),className:"flex items-center gap-1 text-xs",children:[ey(s.status),s.status]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["Created ",(0,h.GP)(new Date(1e3*s.createdAt.seconds),"MMM d, yyyy")]}),s.assignedTo&&(()=>{let e=ex.find(e=>e.uid===s.assignedTo);return e?(0,a.jsxs)("span",{children:["Assigned to ",e.displayName||e.email]}):null})(),s.dueDate&&(0,a.jsxs)("span",{children:["Due ",(0,h.GP)(new Date(1e3*s.dueDate.seconds),"MMM d, yyyy")]})]}),s.remark&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-600 bg-gray-50 p-2 rounded",children:[(0,a.jsx)("strong",{children:"Note:"})," ",s.remark]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,a.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>q({task:e,subtask:s}),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80",children:(0,a.jsx)(E.A,{className:"w-3 h-3"})}),(0,a.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>X({task:e,subtask:s}),className:"backdrop-blur-sm bg-white/60 border-gray-200 hover:bg-white/80 hover:border-red-300 hover:text-red-600",children:(0,a.jsx)(T.A,{className:"w-3 h-3"})})]})]})},s.id))}):(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,a.jsx)("p",{children:"No subtasks yet. Add one to break down this task."})})]})]})]},e.id))})]})]}),(0,a.jsx)(M.lG,{open:!!K,onOpenChange:e=>!e&&H(null),children:(0,a.jsxs)(M.Cf,{className:"max-w-2xl",children:[(0,a.jsx)(M.c7,{children:(0,a.jsx)(M.L3,{children:"Edit Task"})}),K&&(0,a.jsx)(B.g,{task:K,boardId:s,boardMembers:ex,boardStatuses:(null==i?void 0:i.customStatuses)&&i.customStatuses.length>0?i.customStatuses:[{id:"todo",name:"To Do",color:"from-yellow-500 to-orange-600",order:1},{id:"in-progress",name:"In Progress",color:"from-blue-500 to-cyan-600",order:2},{id:"done",name:"Done",color:"from-green-500 to-emerald-600",order:3}],onTaskUpdated:()=>{H(null),O.oR.success("Task updated successfully!")},onClose:()=>H(null)})]})}),(0,a.jsx)(M.lG,{open:!!_,onOpenChange:e=>!e&&q(null),children:(0,a.jsxs)(M.Cf,{className:"max-w-2xl",children:[(0,a.jsx)(M.c7,{children:(0,a.jsx)(M.L3,{children:"Edit Subtask"})}),_&&(0,a.jsx)(P.Q,{subtask:_.subtask,boardId:s,taskId:_.task.id,boardMembers:ex,boardStatuses:(null==i?void 0:i.customStatuses)&&i.customStatuses.length>0?i.customStatuses:[{id:"todo",name:"To Do",color:"from-yellow-500 to-orange-600",order:1},{id:"in-progress",name:"In Progress",color:"from-blue-500 to-cyan-600",order:2},{id:"done",name:"Done",color:"from-green-500 to-emerald-600",order:3}],onSubtaskUpdated:()=>{q(null),O.oR.success("Subtask updated successfully!")},onClose:()=>q(null)})]})}),(0,a.jsx)(M.lG,{open:el,onOpenChange:eo,children:(0,a.jsxs)(M.Cf,{className:"max-w-2xl",children:[(0,a.jsx)(M.c7,{children:(0,a.jsx)(M.L3,{children:"Create New Task"})}),(0,a.jsx)(ed,{boardId:s,boardMembers:ex,boardStatuses:(null==i?void 0:i.customStatuses)&&i.customStatuses.length>0?i.customStatuses:[{id:"todo",name:"To Do",color:"from-yellow-500 to-orange-600",order:1},{id:"in-progress",name:"In Progress",color:"from-blue-500 to-cyan-600",order:2},{id:"done",name:"Done",color:"from-green-500 to-emerald-600",order:3}],onTaskCreated:()=>{O.oR.success("Task created successfully!")},onClose:()=>eo(!1)})]})}),Object.entries(F).map(e=>{let[r,t]=e,l=m.find(e=>e.id===r);return t&&l?(0,a.jsx)(M.lG,{open:t,onOpenChange:()=>ef(r),children:(0,a.jsxs)(M.Cf,{className:"max-w-2xl",children:[(0,a.jsx)(M.c7,{children:(0,a.jsxs)(M.L3,{children:["Add Subtask to ",l.title]})}),(0,a.jsx)(b.m,{boardId:s,taskId:r,boardMembers:ex,boardStatuses:(null==i?void 0:i.customStatuses)&&i.customStatuses.length>0?i.customStatuses:[{id:"todo",name:"To Do",color:"from-yellow-500 to-orange-600",order:1},{id:"in-progress",name:"In Progress",color:"from-blue-500 to-cyan-600",order:2},{id:"done",name:"Done",color:"from-green-500 to-emerald-600",order:3}],onSubtaskCreated:()=>{eg(),ef(r)},onClose:()=>ef(r)})]})},r):null}),(0,a.jsx)(M.lG,{open:es,onOpenChange:er,children:(0,a.jsxs)(M.Cf,{children:[(0,a.jsx)(M.c7,{children:(0,a.jsx)(M.L3,{children:"Invite Member to Board"})}),(0,a.jsx)(J,{boardId:s,onInviteSent:eb,onClose:()=>er(!1)})]})}),(0,a.jsx)(Y,{isOpen:ea,onClose:()=>et(!1),boardId:s,isOwner:ew||!1}),(0,a.jsx)(I.K,{open:!!Q,onOpenChange:e=>!e&&V(null),title:"Delete Task",description:"Are you sure you want to delete '".concat(null==Q?void 0:Q.title,"'? This will also delete all subtasks and cannot be undone."),onConfirm:ej}),(0,a.jsx)(I.K,{open:!!W,onOpenChange:e=>!e&&X(null),title:"Delete Subtask",description:"Are you sure you want to delete '".concat(null==W?void 0:W.subtask.title,"'? This cannot be undone."),onConfirm:ep})]})})}},7737:(e,s,r)=>{"use strict";r.d(s,{E:()=>l});var a=r(5155);r(2115);var t=r(3999);function l(e){let{className:s,...r}=e;return(0,a.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-muted",s),...r})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,965,496,395,778,713,352,509,84,563,531,441,684,358],()=>s(2002)),_N_E=e.O()}]);