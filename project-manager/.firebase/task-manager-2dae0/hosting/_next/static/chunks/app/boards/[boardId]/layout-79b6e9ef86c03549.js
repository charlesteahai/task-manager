(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[751],{1454:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>o});var s=a(5155),t=a(2509);function o(e){let{children:r}=e;return(0,s.jsx)(t.H,{children:r})}},2509:(e,r,a)=>{"use strict";a.d(r,{H:()=>h,t:()=>p});var s=a(5155),t=a(2115),o=a(5317),i=a(8915),n=a(8794),u=a(5695),c=a(6671);let{db:d}=(0,i.M)(),l=(0,t.createContext)(void 0),h=e=>{let{children:r}=e,{user:a}=(0,n.A)(),i=(0,u.useParams)().boardId,[h,p]=(0,t.useState)(null),[f,g]=(0,t.useState)([]),[b,m]=(0,t.useState)({}),[y,k]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{if(!a||!i)return void k(!1);k(!0);let e=[],r=(0,o.aQ)((0,o.H9)(d,"boards",i),e=>{e.exists()?p({id:e.id,...e.data()}):(p(null),c.oR.error("Board not found.")),k(!1)},e=>{console.error("Firestore board listener error:",e),c.oR.error("Failed to load board.",{description:"You may not have permission to view this board."}),p(null),k(!1)});e.push(r);let s=(0,o.P)((0,o.rJ)(d,"boards",i,"tasks")),t=(0,o.aQ)(s,e=>{g(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Firestore tasks listener error:",e),c.oR.error("Failed to load tasks for this board."),g([])});return e.push(t),()=>e.forEach(e=>e())},[a,i]),(0,t.useEffect)(()=>{if(0===f.length)return;let e=[];return m({}),f.forEach(r=>{let a=(0,o.P)((0,o.rJ)(d,"boards",i,"tasks",r.id,"subtasks")),s=(0,o.aQ)(a,e=>{let a=e.docs.map(e=>({id:e.id,...e.data()}));m(e=>({...e,[r.id]:a}))},e=>{console.error("Firestore subtasks listener error for task ".concat(r.id,":"),e),c.oR.error("Failed to load subtasks for task: ".concat(r.title))});e.push(s)}),()=>e.forEach(e=>e())},[f,i]),(0,s.jsx)(l.Provider,{value:{board:h,tasks:f,subtasks:b,loading:y},children:r})},p=()=>{let e=(0,t.useContext)(l);if(void 0===e)throw Error("useRealtimeData must be used within a RealtimeDataProvider");return e}},8627:(e,r,a)=>{Promise.resolve().then(a.bind(a,1454))},8794:(e,r,a)=>{"use strict";a.d(r,{A:()=>g,AuthProvider:()=>f});var s=a(5155),t=a(2115),o=a(6203),i=a(8915),n=a(5317),u=a(6671),c=a(5695),d=a(3915);let l=(0,t.createContext)({user:null,loading:!0,signUp:async()=>{},signIn:async()=>{},signInWithGoogle:async()=>{},signOut:async()=>{},handleAuthError:()=>{},refreshUser:()=>{},notifications:[],setNotifications:()=>{}}),{auth:h,db:p}=(0,i.M)(),f=e=>{let{children:r}=e,[a,i]=(0,t.useState)(null),[f,g]=(0,t.useState)(!0),b=(0,c.useRouter)(),[m,y]=(0,t.useState)([]),k=async e=>{try{let r=(0,n.H9)(p,"users",e.uid);await (0,n.BN)(r,{uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL},{merge:!0})}catch(e){console.error("Error creating user document:",e)}},v=(e,r)=>{console.error("Auth error during ".concat(r,":"),e);let a="An unexpected error occurred. Please try again.";if(e instanceof d.g)switch(e.code){case"auth/email-already-in-use":a="This email is already in use. Please use a different email or log in.";break;case"auth/user-not-found":case"auth/wrong-password":a="Invalid email or password. Please try again.";break;case"auth/invalid-email":a="The email address is not valid.";break;case"auth/user-disabled":a="This user account has been disabled.";break;case"auth/too-many-requests":a="Too many attempts. Please try again later.";break;case"auth/popup-closed-by-user":a="The sign-in popup was closed before completion.";break;default:a=e.message}u.oR.error("Authentication Failed",{description:a})},w=async(e,r)=>{try{let a=await (0,o.eJ)(h,e,r);return a.user&&(k(a.user),u.oR.success("Account created successfully!"),b.push("/dashboard")),a}catch(e){v(e,"sign-up")}},E=async(e,r)=>{try{let a=await (0,o.x9)(h,e,r);return a.user&&(u.oR.success("Signed in successfully!"),b.push("/dashboard")),a}catch(e){v(e,"sign-in")}},P=async()=>{try{let e=new o.HF,r=await (0,o.df)(h,e);return r.user&&(k(r.user),u.oR.success("Signed in successfully!"),b.push("/dashboard")),r}catch(e){v(e,"sign-in-with-google")}},R=async()=>{try{await (0,o.CI)(h),i(null),b.push("/login")}catch(e){console.error("Error signing out: ",e),v(e,"sign-out")}};return(0,t.useEffect)(()=>{let e=(0,o.hg)(h,e=>{i(e),g(!1)});return()=>e()},[]),(0,s.jsx)(l.Provider,{value:{user:a,loading:f,signUp:w,signIn:E,signInWithGoogle:P,signOut:R,handleAuthError:v,refreshUser:()=>{h.currentUser&&h.currentUser.reload().then(()=>{i(h.currentUser)})},notifications:m,setNotifications:y},children:r})},g=()=>(0,t.useContext)(l)},8915:(e,r,a)=>{"use strict";a.d(r,{M:()=>c});var s=a(3915),t=a(6203),o=a(5317),i=a(1427),n=a(858);let u={apiKey:"AIzaSyDAzvB41J4jsrKvNAomLQD209_PqwNeC9I",authDomain:"task-manager-2dae0.firebaseapp.com",projectId:"task-manager-2dae0",storageBucket:"task-manager-2dae0.firebasestorage.app",messagingSenderId:"34619415429",appId:"1:34619415429:web:8d4105d1fcf3a9b60ac2ec"};function c(){let e=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)(u),r=(0,t.xI)(e),a=(0,o.aU)(e),c=(0,i.Uz)(e),d=(0,n.c7)(e);return{app:e,auth:r,db:a,functions:c,storage:d}}}},e=>{var r=r=>e(e.s=r);e.O(0,[992,965,496,441,684,358],()=>r(8627)),_N_E=e.O()}]);